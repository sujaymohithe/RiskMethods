(this.webpackJsonpriskmethods_indicator=this.webpackJsonpriskmethods_indicator||[]).push([[0],{49:function(e,t,a){e.exports=a(89)},54:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){},57:function(e,t,a){},81:function(e,t,a){},82:function(e,t,a){},85:function(e,t,a){},86:function(e,t,a){},89:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"auth",(function(){return $}));var r={};a.r(r),a.d(r,"indicatorMessage",(function(){return q}));var c=a(0),o=a.n(c),l=a(19),s=a.n(l),i=(a(54),a(55),a(56),function(e){return o.a.createElement("header",{className:"mainHeader"},o.a.createElement("div",null,o.a.createElement("a",{href:"/","data-test":"Logo",className:"logo"},"RISK METHODS")),e.isAuthenticated&&o.a.createElement("div",{className:"divProfile"},o.a.createElement("p",{className:"logo"},"Welcome ",localStorage.userId&&localStorage.userId.split("@")[0]),o.a.createElement("a",{href:"/logout",className:"logo signout"},"Logout")))}),u=a(14),m=a(21),d=a(10),g=a(42),E=a(44),f=a(46),h=a(90),p=(a(57),a(16)),b=a.n(p),_="fjHsalRElzo6JB_dvIGx6pw2p4WMT0pMjhtcW7d159Q",I="dSANY4dUV8cn-24WD8R9tBlWtWM70RrabWbfOne442o",S="https://cors-anywhere.herokuapp.com/https://stagingapi.riskmethods.net/v2/",v=function(e,t){return{type:"AUTH_SUCCESS",idToken:e,userId:t}},T=function(e){return{type:"AUTH_FAIL",error:e}},A=function(){return localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("expirationDate"),localStorage.removeItem("userId"),{type:"AUTH_LOGOUT"}},O=function e(t){return function(a){setTimeout((function(){var t={grant_type:"refresh_token",client_id:_,client_secret:I,refresh_token:localStorage.refresh_token};b.a.post("https://cors-anywhere.herokuapp.com/https://stagingauth.riskmethods.net/oauth/token",t).then((function(t){var n=new Date((new Date).getTime()+1e3*t.data.expires_in);localStorage.setItem("token",t.data.access_token),localStorage.setItem("refresh_token",t.data.refresh_token),localStorage.setItem("expirationDate",n),localStorage.setItem("userId",localStorage.userId),a(e(t.data.expires_in))})).catch((function(e){a(T(e.response.data.error))}))}),1e3*(t-180))}},y=function(e){return{type:"GET_INDICATOR_MESSAGES",list:e}},k=a(8),j=Object(k.b)((function(e){return{loading:e.auth.loading,error:e.auth.error,isAuthenticated:null!==e.auth.token,authRedirectPath:e.auth.authRedirectPath}}),(function(e){return{onAuth:function(t,a){return e(function(e,t){return function(a){a({type:"AUTH_START"});var n={grant_type:"password",username:e,password:t,client_id:_,client_secret:I};b.a.post("https://cors-anywhere.herokuapp.com/https://stagingauth.riskmethods.net/oauth/token",n).then((function(e){var t=new Date((new Date).getTime()+1e3*e.data.expires_in);localStorage.setItem("token",e.data.access_token),localStorage.setItem("refresh_token",e.data.refresh_token),localStorage.setItem("expirationDate",t),localStorage.setItem("userId",n.username),a(v(e.data.access_token,n.username)),a(O(e.data.expires_in))})).catch((function(e){a(T(e.response.data.error))}))}}(t,a))},onSetAuthRedirectPath:function(){return e({type:"SET_AUTH_REDIRECT_PATH",path:"/"})}}}))((function(e){var t=Object(c.useState)(""),a=Object(d.a)(t,2),n=a[0],r=a[1],l=Object(c.useState)(""),s=Object(d.a)(l,2),i=s[0],m=s[1],p=null;e.isAuthenticated&&(p=o.a.createElement(u.a,{to:e.authRedirectPath}));var b=null;return e.error&&(b="Please enter valid credentials"),o.a.createElement("div",{className:"Auth"},p,o.a.createElement("div",{className:"col-sm-3 ml-auto mr-auto pt-5"},o.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.onAuth(n,i)}},o.a.createElement(g.a,{controlId:"message"},o.a.createElement(E.a,{className:"danger"},o.a.createElement("b",null,b))),o.a.createElement(g.a,{controlId:"username"},o.a.createElement(E.a,null,o.a.createElement("b",null,"Email address")),o.a.createElement(f.a,{autoFocus:!0,type:"username",value:n,name:"username",placeholder:"Enter your email address",onChange:function(e){r(e.target.value)}})),o.a.createElement(g.a,{controlId:"password"},o.a.createElement(E.a,null,o.a.createElement("b",null,"Password")),o.a.createElement(f.a,{value:i,type:"password",name:"password",placeholder:"Enter your password",onChange:function(e){m(e.target.value)}})),o.a.createElement(h.a,{block:!0,className:"col-sm-6 offset-sm-4 mt-4",type:"submit",disabled:e.loading},e.loading?"Please Wait...":"Login"))))})),D=a(93),N=a(91),w=a(45),C=a(92),M=(a(81),function(e){return e.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/gi,(function(e){return'<a href="'+e+'">'+e+"</a>"}))}),R=function(e){var t=e.data,a=t.id,n=t.attributes,r=parseInt(n.risk_score.value),c=r>=0&&r<=50?"success":r>50&&r<=80?"warning":"danger",l="/indicator_messages/".concat(a),s="Created on ".concat(new Date(n.created_at).toLocaleDateString(),"\n    at ").concat(new Date(n.created_at).toLocaleTimeString()," by system");return o.a.createElement(N.a,null,o.a.createElement(w.a,{sm:12},o.a.createElement("div",{className:"Boxwidget"},o.a.createElement("div",{className:"box-left"},o.a.createElement("div",{className:"CardLeftFooter"},o.a.createElement("p",null,n.indicator_message_type)),o.a.createElement("div",{className:"Cardblock"},o.a.createElement("h5",null,o.a.createElement(C.a,{variant:c},r)))),o.a.createElement("div",{className:"box-right"},o.a.createElement("div",{className:"Cardblock"},o.a.createElement("p",{dangerouslySetInnerHTML:{__html:M(n.body)}}),o.a.createElement("p",null,s),o.a.createElement("p",null,"Source : ",n.source),o.a.createElement("b",null,"Indicator : ",n.subject)),o.a.createElement("div",{className:"CardRightFooter mb-2"},o.a.createElement(h.a,{href:l,variant:"primary",size:"sm"},"Details"))))))},L=a(95),G=a(94),x=(a(82),a(47)),H=a.n(x),F=function(e){var t=Object(c.useState)(0),a=Object(d.a)(t,2),n=a[0],r=a[1],l=Object(c.useState)(100),s=Object(d.a)(l,2),i=s[0],u=s[1],m=Object(c.useState)(!1),g=Object(d.a)(m,2),E=g[0],f=g[1];return o.a.createElement("div",{className:"frmFilter"},o.a.createElement(G.a,{onSubmit:function(t){t.preventDefault(),n>i?H.a.warning("Min score should be smaller than max score"):e.onFiterIndicatorMessages(E,n,i)}},o.a.createElement(G.a.Group,{controlId:"ControlInput"},o.a.createElement(G.a.Label,null,o.a.createElement("b",null,"EVENTS (RISK SCORE 100)")),o.a.createElement(G.a.Check,{"aria-label":"option 1",checked:E,onChange:function(e){f(e.target.checked)}})),o.a.createElement(G.a.Group,{controlId:"ControlSelect"},o.a.createElement(G.a.Label,null,o.a.createElement("b",null,"RISK SCORE")),o.a.createElement(G.a.Group,{controlId:"formRange"},o.a.createElement(G.a.Label,null,"From : ",n),o.a.createElement(G.a.Control,{type:"range",value:n,onChange:function(e){r(parseInt(e.target.value))}})),o.a.createElement(G.a.Group,{controlId:"toRange"},o.a.createElement(G.a.Label,null,"To : ",i),o.a.createElement(G.a.Control,{type:"range",value:i,onChange:function(e){u(parseInt(e.target.value))}}))),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(G.a.Group,{controlId:"ControlSubmit"},o.a.createElement("div",{className:"mb-2"},o.a.createElement(h.a,{variant:"primary",type:"submit",size:"sm"},"Submit")," ",o.a.createElement(h.a,{variant:"secondary",size:"sm",onClick:function(){f(!1),r(0),u(100),e.onResetIndicatorMessages()}},"Reset")))))},U=Object(k.b)((function(e){return{indicatorMessagesList:e.indicatorMessage.messages,metaData:e.indicatorMessage.messages.meta,loading:e.indicatorMessage.loading}}),(function(e){return{onInitIndicatorMessages:function(t,a,n,r){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,r={Authorization:"Bearer "+localStorage.token,"content-type":"application/json"},c="".concat(S,t?"indicator_messages?filter[event]=true&":"indicator_messages?"),o=t?"":"&filter[risk_score_min]=".concat(a,"&filter[risk_score_max]=").concat(n);return function(t){t({type:"INDICATOR_MESSAGES_START"}),b.a.get("".concat(c,"page[size]=\n        20&fields[indicator_message]=name,subject,created_at,body,source,\n        indicator_message_type,risk_score&page[number]=").concat(e).concat(o),{headers:r}).then((function(e){t(y(e.data))})).catch((function(e){t({type:"FETCH_INDICATOR_MESSAGES_FAILED"})}))}}(t,a,n,r))}}}))((function(e){var t=e.onInitIndicatorMessages,a=Object(c.useState)(1),n=Object(d.a)(a,2),r=n[0],l=n[1],s=Object(c.useState)("0"),i=Object(d.a)(s,2),u=i[0],m=i[1],g=Object(c.useState)("100"),E=Object(d.a)(g,2),f=E[0],h=E[1],p=Object(c.useState)(!1),b=Object(d.a)(p,2),_=b[0],I=b[1],S=[];Object(c.useEffect)((function(){t()}),[t]);if(e.metaData)for(var v=1;v<=e.metaData.total_pages;v++)S.push(o.a.createElement(L.a.Item,{key:v,active:v===r},v));return o.a.createElement(o.a.Fragment,null,o.a.createElement(w.a,{sm:"3"},o.a.createElement(F,{onFiterIndicatorMessages:function(e,a,n){l(1),I(e),m(a),h(n),t(1,e,a,n)},onResetIndicatorMessages:function(){l(1),I(!1),m(0),h(100),t(1,!1,0,100)}})),o.a.createElement(w.a,{sm:"9"},o.a.createElement(D.a,null,o.a.createElement("h4",null,"Indicator Messages"),o.a.createElement("div",{className:"floaterR"},o.a.createElement(L.a,{onClick:function(e){l(parseInt(e.target.text)),t(e.target.text,_,u,f)}},S)),e.loading&&o.a.createElement("h5",null,"Please wait ..."),!e.loading&&e.indicatorMessagesList&&e.indicatorMessagesList.data&&e.indicatorMessagesList.data.map((function(e,t){return function(e,t){return o.a.createElement(R,{data:e,key:t})}(e,t)})),!e.loading&&e.indicatorMessagesList&&e.indicatorMessagesList.data&&0===e.indicatorMessagesList.data.length&&o.a.createElement("h4",null,"No results, please refine your filters"))))})),P=(a(85),function(e){return e.isAuthenticated||e.history.push("/auth"),o.a.createElement("div",{className:"app-body"},o.a.createElement(D.a,null,o.a.createElement(N.a,{className:"justify-content-md-center"},e.isAuthenticated&&o.a.createElement(U,null))))}),W=a(96),B=(a(86),Object(k.b)((function(e){return{indicatorMessageData:e.indicatorMessage.messageData,loading:e.indicatorMessage.loading}}),(function(e){return{onInitIndicatorMessageDetails:function(t){return e(function(e){var t={Authorization:"Bearer "+localStorage.token,"content-type":"application/json"};return function(a){a({type:"INDICATOR_MESSAGES_START"}),b.a.get("".concat(S,"indicator_messages/").concat(e,"?fields[indicator_message]=risk_score,name,subject,body,created_at,body,source,indicator_message_type"),{headers:t}).then((function(e){a({type:"GET_INDICATOR_MESSAGE_DETAILS",data:e.data})})).catch((function(e){a({type:"FETCH_INDICATOR_MESSAGE_DETAILS_FAILED"})}))}}(t))}}}))((function(e){localStorage.token||e.history.push("/auth");var t=e.match.params.id,a=e.onInitIndicatorMessageDetails;if(Object(c.useEffect)((function(){a(t)}),[a,t]),e.loading)return o.a.createElement("div",{className:"app-body"},o.a.createElement(D.a,null,o.a.createElement(N.a,null,o.a.createElement("h5",null,"Please Wait ..."))));var n=e.indicatorMessageData.data.attributes,r=n&&parseInt(n.risk_score.value),l=r>=0&&r<=50?"success":r>50&&r<=80?"warning":"danger",s="Created on ".concat(new Date(n.created_at).toLocaleDateString(),"\n            at ").concat(new Date(n.created_at).toLocaleTimeString()," by system");return o.a.createElement("div",{className:"app-body"},o.a.createElement(D.a,null,o.a.createElement(N.a,null,o.a.createElement(w.a,{sm:12},o.a.createElement("h3",null,"Indicator Message"),o.a.createElement("a",{href:"/",className:"navLink"},"Back to Indicator Messages"),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("div",{className:"Boxwidget"},o.a.createElement("div",{className:"box-left"},o.a.createElement("div",{className:"CardLeftFooter"},o.a.createElement("p",null,n.name)),o.a.createElement("div",{className:"Cardblock"},o.a.createElement("h5",null,o.a.createElement(C.a,{variant:l},r)),o.a.createElement("h5",null,o.a.createElement(W.a,{className:"progressive",animated:!0,variant:l,now:r})),o.a.createElement("h6",null,"Risk Score already set"))),o.a.createElement("div",{className:"box-right"},o.a.createElement("div",{className:"Cardblock"},o.a.createElement("p",null,o.a.createElement("b",null,n.subject)),o.a.createElement("p",null,s),o.a.createElement("p",{className:"msg-body",dangerouslySetInnerHTML:{__html:M(n.body)}}))))))))}))),z=Object(k.b)(null,(function(e){return{onLogout:function(){return e(A())}}}))((function(e){var t=e.onLogout;return Object(c.useEffect)((function(){t()}),[t]),o.a.createElement(u.a,{to:"/"})})),J=function(e){var t=e.isAuthenticated,a=o.a.createElement(u.d,null,o.a.createElement(u.b,{path:"/auth",render:function(e){return o.a.createElement(j,e)}}),o.a.createElement(u.b,{path:"/logout",component:z}),o.a.createElement(u.b,{exact:!0,path:"/",render:function(e){return o.a.createElement(P,Object.assign({},e,{isAuthenticated:t}))}}),o.a.createElement(u.b,{path:"/indicator_messages/:id",render:function(e){return o.a.createElement(B,Object.assign({},e,{isAuthenticated:t}))}}),o.a.createElement(u.a,{to:"/"}));return o.a.createElement(m.a,null,a)},K=Object(k.b)((function(e){return{isAuthenticated:null!==e.auth.token}}),(function(e){return{onTryAutoSignup:function(){return e((function(e){var t=localStorage.getItem("token");if(t){var a=new Date(localStorage.getItem("expirationDate"));if(a<=new Date)e(A());else{var n=localStorage.getItem("userId");e(v(t,n)),e(O((a.getTime()-(new Date).getTime())/1e3))}}else e(A())}))}}}))((function(e){var t=e.onTryAutoSignup;return Object(c.useEffect)((function(){t()}),[t]),o.a.createElement("div",null,o.a.createElement(i,e),o.a.createElement(J,e))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(87);var V=a(28),Z=a(13),Q=a(48),Y={token:null,userId:null,error:null,loading:!1,authRedirectPath:"/"};function $(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_START":return Object.assign({},e,{error:null,loading:!0});case"AUTH_SUCCESS":return Object.assign({},e,{token:t.idToken,userId:t.userId,error:null,loading:!1});case"AUTH_FAIL":return Object.assign({},e,{error:t.error,loading:!1});case"AUTH_LOGOUT":return Object.assign({},e,{token:null,userId:null});case"SET_AUTH_REDIRECT_PATH":return Object.assign({},e,{authRedirectPath:t.path});default:return e}}function q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{messages:[],error:!1,messageData:{},loading:!0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INDICATOR_MESSAGES_START":return Object.assign({},e,{error:null,loading:!0});case"GET_INDICATOR_MESSAGES":return Object.assign({},e,{messages:t.list,loading:!1});case"FETCH_INDICATOR_MESSAGES_FAILED":return Object.assign({},e,{error:!0,loading:!1});case"GET_INDICATOR_MESSAGE_DETAILS":return Object.assign({},e,{messageData:t.data,loading:!1});case"FETCH_INDICATOR_MESSAGE_DETAILS_FAILED":return Object.assign({},e,{error:!0,loading:!1});default:return e}}var X,ee=Object(Z.c)(Object(V.a)(Object(V.a)({},n),r));"undefined"!==typeof window&&(X=window.__INITIAL_STATE__,delete window.__INITIAL_STATE__);var te=Object(Z.e)((function(e,t){return"RESET"===t.type&&(e=void 0),ee(e,t)}),X,Object(Z.d)(Object(Z.a)(Q.a)));a(88);s.a.render(o.a.createElement(k.a,{store:te},o.a.createElement(K,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[49,1,2]]]);
//# sourceMappingURL=main.567ce096.chunk.js.map